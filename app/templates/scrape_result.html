<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrape Result</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/table.css') }}">
</head>
<body>

<h2>Gescrapte Links</h2>

<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>Link</th>
                <th>Auswahl</th>
            </tr>
        </thead>
        <tbody>
            {% for page_id, page_data in url_mapping.items() | list %}
            <tr>
                <td>
                    <span class="toggle-btn" onclick="toggleChildren('{{ page_id }}', this)">â–¶</span>
                    <a href="{{ page_data.url }}" class="link" target="_blank">{{ page_data.title }}</a>
                </td>
                <td><input type="checkbox" class="link-checkbox" data-url="{{ page_data.url }}"></td>
            </tr>
            {% for child_id in page_data.children %}
            <tr class="child-row child-of-{{ page_id }}">
                <td style="padding-left: 20px;">
                    <a href="{{ url_mapping[child_id].url }}" class="link" target="_blank">{{ url_mapping[child_id].title }}</a>
                </td>
                <td><input type="checkbox" class="link-checkbox" data-url="{{ url_mapping[child_id].url }}"></td>
            </tr>
            {% endfor %}
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    function toggleChildren(parentId, toggleBtn) {
        const childRows = document.querySelectorAll(`.child-of-${parentId}`);
        const isCollapsed = toggleBtn.classList.contains('collapsed');

        childRows.forEach(row => {
            row.style.display = isCollapsed ? 'none' : 'table-row';
        });

        toggleBtn.classList.toggle('collapsed', !isCollapsed);
    }
</script>

</body>
</html>
